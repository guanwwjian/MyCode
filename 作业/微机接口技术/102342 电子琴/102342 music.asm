SSEG SEGMENT STACK
	DB 100 DUP(0)
	TOS DB 0
SSEG ENDS

DSEG SEGMENT
	TABLE DW 524,588,660,698,784,880,988,1048
	KC DB 0,1,2,3,4,5,6,7
DSEG ENDS

ESEG SEGMENT

ESEG ENDS

CSEG SEGMENT
	ASSUME SS:SSEG, DS:DSEG, ES:ESEG, CS:CSEG
	
SQUAR  PROC  NEAR  
       PUSH  AX  
       PUSH  DX  
       PUSH  CX  
       PUSH  DI  
       PUSH  SI  
    
        
       ADD    DI,CX  
       ADD    SI,DX  
       PUSH CX
HLINE: 
			 POP CX 
       PUSH CX
HAGAIN:    
       MOV    AH,0CH  
       MOV    BH,0  
       INT    10H  
       INC    CX  
       CMP    CX,DI  
       JL     HAGAIN  
       ADD    DX,1  
       CMP    DX,SI  
       JL     HLINE  
       POP CX
       POP    SI  
       POP    DI  
       POP    CX  
       POP    DX  
       POP    AX  
    RET  
SQUAR ENDP  
	
SOUNDSTA PROC NEAR
	PUSH AX
	PUSH BX
	PUSH CX
	PUSH DX
	PUSH SI
	PUSH DI
	PUSH BP
	PUSHF
	
	MOV AL,0B6H
	OUT 43H,AL
	MOV DX,12H
	MOV AX,348CH
	DIV BX
	OUT 42H,AL
	MOV AL,AH
	OUT 42H,AL
	IN AL,61H
	OR AL,03H
	OUT 61H,AL
	
	
	POPF
	POP BP
	POP DI
	POP SI
	POP DX
	POP CX
	POP BX
	POP AX
	RET
SOUNDSTA ENDP

SOUNDEND PROC NEAR
	PUSH AX
	PUSH BX
	PUSH CX
	PUSH DX
	PUSH SI
	PUSH DI
	PUSH BP
	PUSHF
	
	IN AL,61H
	AND AL,0FCH
	OUT 61H,AL
	
	POPF
	POP BP
	POP DI
	POP SI
	POP DX
	POP CX
	POP BX
	POP AX
	RET
SOUNDEND ENDP

KEY PROC FAR
PUSH AX
	PUSH BX
	PUSH CX
	PUSH DX
	PUSH SI
	PUSH DI
	PUSH BP
	PUSHF
	

	MOV CX,80
	MOV DX,50
	MOV SI,100
	MOV DI,19
	MOV AL,KC
	CALL SQUAR
	MOV CX,100
	MOV DX,50
	MOV SI,100
	MOV DI,19
	MOV AL,KC+1
	CALL SQUAR
	MOV CX,120
	MOV DX,50
	MOV SI,100
	MOV DI,19
	MOV AL,KC+2
	CALL SQUAR
	MOV CX,140
	MOV DX,50
	MOV SI,100
	MOV DI,19
	MOV AL,KC+3
	CALL SQUAR
	MOV CX,160
	MOV DX,50
	MOV SI,100
	MOV DI,19
	MOV AL,KC+4
	CALL SQUAR
	MOV CX,180
	MOV DX,50
	MOV SI,100
	MOV DI,19
	MOV AL,KC+5
	CALL SQUAR
	MOV CX,200
	MOV DX,50
	MOV SI,100
	MOV DI,19
	MOV AL,KC+6
	CALL SQUAR
	MOV CX,220
	MOV DX,50
	MOV SI,100
	MOV DI,19
	MOV AL,KC+7
	CALL SQUAR

	
	POPF
	POP BP
	POP DI
	POP SI
	POP DX
	POP CX
	POP BX
	POP AX
	RET
KEY ENDP
MAIN PROC FAR
	MOV AX,DSEG
	MOV DS,AX
	MOV AX,ESEG
	MOV ES,AX
	MOV AX,SSEG
	MOV SS,AX
	LEA SP,TOS
	MOV    AH,0              
  MOV    AL,13H  
  INT    10H 
  MOV CX,0
	MOV DX,0
	MOV SI,200
	MOV DI,320
	MOV AL,1
	CALL SQUAR
REPEAT1:	
	MOV [KC],7
	MOV [KC+1],7
	MOV [KC+2],7
	MOV [KC+3],7
	MOV [KC+4],7
	MOV [KC+5],7
	MOV [KC+6],7
	MOV [KC+7],7
	CALL KEY
	MOV AH,0
	INT 16H
	CMP AL,'1'
	JL EXIT
	CMP AL,'8'
	JG EXIT
	MOV DX,AX
	MOV BL,AL
	SUB BL,'1'
	AND BX,0FH
	MOV KC[BX],4
	SHL BX,1
	MOV BX,TABLE[BX]
	CALL KEY
	CALL SOUNDSTA
REPEAT2:	IN AL,60H
	TEST AL,80H
	JZ REPEAT2
	CALL SOUNDEND
	JMP REPEAT1

EXIT:MOV    AH,0              
  MOV    AL,02H  
  INT    10H 	
	MOV AH,4CH
	INT 21H
MAIN ENDP

CSEG ENDS

END MAIN